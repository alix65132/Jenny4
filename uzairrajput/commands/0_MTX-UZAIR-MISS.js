const request = require('request');
const fs = require('fs');
const path = require('path');

module.exports.config = {
    name: "miss-you-too-sad",
    version: "1.0.1",
    hasPermssion: 0,
    credits: "uzairrajput",
    description: "no prefix",
  usePrefix: false,
    commandCategory: "No command marks needed",
    usages: "Yo Yo",
    cooldowns: 5,
};

const gifs = [
    "https://i.imgur.com/ThUlrRv.gif",
    "https://i.imgur.com/2RpW0X4.gif",
    "https://i.imgur.com/xi8zL3Q.gif",
    "https://i.imgur.com/53bK6Xb.gif",
    "https://i.imgur.com/FmSAX0Z.gif",
    "https://i.imgur.com/69oq8rV.gif",
    "https://i.imgur.com/v8kAL42.gif",
    "https://i.imgur.com/lVgQHgN.gif",
    "https://i.imgur.com/1yYfb7d.gif",
];

const messages = [
    "ð‘²ð‘¬ ð’€ð‘¬ ð‘ºð‘¨ð‘ªð‘¯  ð‘¯ð‘¨ð‘°ð‘° ð‘²ð‘¬  ð‘¼ð‘ºð‘²ð‘¬ ð‘©ð‘°ð‘°ð‘µð‘¨ ð‘«ð‘°ð‘³ ð‘µð‘¨ð‘¯ð‘° ð‘³ð‘¨ð‘®ð‘»ð‘¨,  \nð‘²ð‘¬ ð’€ð‘¬ ð‘ºð‘¨ð‘ªð‘¯ ð‘¯ð‘¨ð‘°  ð‘¼ð‘º ð‘°ð‘µð‘ºð‘¨ð‘µ ð‘²ð‘¬ ð‘©ð‘°ð‘µð‘¨ ð‘«ð‘°ð‘³ ð‘µð‘¨ð‘¯ð‘° ð‘³ð‘¨ð‘®ð‘»,\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\n {name}à¥¤ \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘´ð‘¬ ð‘²ð‘¨ð‘©ð‘¯ð‘° ð‘²ð‘¨ð‘©ð‘¯ð‘° ð‘ºð‘¶ð‘¯ð‘»ð‘° ð‘²ð‘¬ ð‘¾ð‘¶ ð‘°ð‘µð‘ºð‘¨ð‘µð‘¬ ð‘´ð‘¼ð‘±ð‘¯ð‘¬ ð‘µð‘¨ ð‘´ð‘°ð‘³ð‘¬ ð‘»ð‘¾. ð‘´ð‘¬ð‘¹ð‘° ð’ð‘°ð‘µð‘«ð‘¨ð‘®ð‘° ð‘²ð‘¨ð‘ºð‘¬ ð‘®ð‘¼ð’ð‘¹ð‘¬ð‘®ð‘°. ðŸ˜”\n\nð‘´ð‘¨ð‘«ð‘¬ ð‘©ð’€\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘´ð’“ð‘¼ð’›ð’‚ð’Šð’“ð‘¿ð’™ð‘¿-ð‘´ð‘»ð‘¿ â—ˆ â”€â”€â”€â”€ ðŸ’šâœ¨",
    "ð‘²ð‘¨ð‘©ð‘¯ð‘°. ð‘²ð‘¨ð‘©ð‘¯ð‘° ð‘¯ð‘¼ð‘´ ð‘²ð‘°ð‘ºð‘° ð‘²ð‘¶ ð‘°ð‘»ð‘µð‘¨ ð‘´ð‘°ð‘ºð‘º ð‘²ð‘¨ð‘¹ ð‘¹ð‘¨ð‘¯ð‘¬ ð‘¯ð‘¶ð‘»ð‘¬ ð‘¯ð‘¨ð‘°\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨, {name}à¥¤ \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘²ð‘¬ ð‘¨ð‘µð‘²ð‘¯ð‘¶ð‘µ ð‘ª ð‘¨ð‘µð‘ºð‘¶ð‘¶ ð‘¨ð‘·ð‘µð‘¬ ð‘¨ð‘· ð‘µð‘°ð‘²ð‘¨ð‘³ð‘µð‘¬ ð‘³ð‘¨ð‘®ð‘»ð‘¬ ð‘¯ð‘¨ð‘° ð‘¶ð‘¹ ð‘«ð‘°ð‘³ ð‘ºð‘°ð‘¹ð‘­ ð‘¼ð‘µð‘ºð‘¬ ð‘¯ð‘° ð‘©ð‘¨ð‘» ð‘²ð‘¨ð‘¹ð‘µð‘¬ ð‘²ð‘¶ ð‘²ð‘¨ð‘¹ð‘»ð‘¨ ð‘¯ð‘¨ð‘° ðŸ’”\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\n ð‘° ð‘´ð‘°ð‘ºð‘º ð’€ð‘¶ð‘¼ ðŸ¥ºðŸ’¯ðŸ¥€ð‘´ð‘¨ð‘«ð‘¬ ð‘©ð’€\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘´ð’“ð‘¼ð’›ð’‚ð’Šð’“ð‘¿ð’™ð‘¿-ð‘´ð‘»ð‘¿ â—ˆ â”€â”€â”€â”€ ðŸ’šâœ¨",
    "ð‘° ð‘´ð‘°ð‘ºð‘º ð’€ð‘¶ð‘¼ð‘¹ ð‘½ð‘¶ð‘°ð‘ªð‘¬, \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘° ð‘´ð‘°ð‘ºð‘º ð’€ð‘¶ð‘¼ð‘¹ ð‘ºð‘´ð‘°ð‘³ð‘¬,  \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘° ð‘´ð‘°ð‘ºð‘º ð’€ð‘¶ð‘¼ð‘¹. ð‘­ð‘¨ð‘ªð‘¬,\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘° ð‘´ð‘°ð‘ºð‘º ð’€ð‘¶ð‘¼ð‘¹ ð‘±ð‘¶ð‘²ð‘¬, \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\ð‘° ð‘´ð‘°ð‘ºð‘º ð’€ð‘¶ð‘¼ð‘¹ ð‘¯ð‘¼ð‘®, \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\n{name}à¥¤ \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘° ð‘´ð‘°ð‘ºð‘º. ð’€ð‘¶ð‘¼ð‘¹. ð‘¬ð‘½ð‘¬ð‘¹ð’€ð‘»ð‘¯ð‘°ð‘µð‘®ðŸ˜¢ \n\nð‘´ð‘¨ð‘«ð‘¬ ð‘©ð’€\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘´ð’“ð‘¼ð’›ð’‚ð’Šð’“ð‘¿ð’™ð‘¿-ð‘´ð‘»ð‘¿ â—ˆ â”€â”€â”€â”€ ðŸ’šâœ¨",
    "ð‘° ð‘¯ð‘¶ð‘·ð‘¬ ð’€ð‘¶ð‘¼ ð‘²ð‘µð‘¶ð‘¾ ð‘»ð‘¯ð‘¨ð‘», ð‘°ð‘´ ð‘»ð‘¯ð‘°ð‘µð‘²ð‘°ð‘µð‘® ð‘¨ð‘©ð‘¶ð‘¼ð‘» ð’€ð‘¶ð‘¼,  \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\n{name}à¥¤ \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘° ð‘´ð‘°ð‘ºð‘º ð’€ð‘¶ð‘¼ ðŸ˜ž,\n\nð‘´ð‘¨ð‘«ð‘¬ ð‘©ð’€\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘´ð’“ð‘¼ð’›ð’‚ð’Šð’“ð‘¿ð’™ð‘¿-ð‘´ð‘»ð‘¿ â—ˆ â”€â”€â”€â”€ ðŸ’šâœ¨",
    "ð‘´ð‘¬ð‘¹ð‘¨ ð‘«ð‘°ð‘³ ð‘»ð‘¬ð‘¹ð‘¬ ð‘©ð‘°ð‘µð‘¨ ð‘¼ð‘«ð‘¨ð‘º ð‘¯ð‘¨ð‘°,\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\n {name},\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\n ð‘´ð‘¬ ð‘»ð‘¼ð‘´ð‘¯ð‘¬ ð‘©ð‘¯ð‘¶ð‘» ð’€ð‘¨ð‘« ð‘²ð‘¨ð‘¹ð‘»ð‘° ð‘¯ð‘¶ð‘µ  ðŸ˜”\n\nð‘´ð‘¨ð‘«ð‘¬ ð‘©ð’€\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘´ð’“ð‘¼ð’›ð’‚ð’Šð’“ð‘¿ð’™ð‘¿-ð‘´ð‘»ð‘¿ â—ˆ â”€â”€â”€â”€ ðŸ’šâœ¨",
    "ð‘¾ð‘¶ð‘¯ ð‘³ð‘¨ð‘´ð‘¯ð‘¬ ð‘±ð‘°ð‘º. ð‘´ð‘¬ ð‘»ð‘¼ð‘´ ð‘´ð‘¬ð‘¹ð‘¬ ð‘ºð‘¨ð‘»ð‘¯ ð‘»ð‘¯ð‘¬, ð‘¾ð‘¶ð‘¯ ð’€ð‘¨ð‘«ð‘¬ð‘¬ð‘°ð‘µ ð‘¨ð‘±  ð‘©ð‘¯ð‘° ð‘´ð‘¼ð‘±ð‘¯ð‘¬ ð‘©ð‘¯ð‘¶ð‘» ð‘»ð‘¨ð‘²ð‘³ð‘¬ð‘¬ð‘­ ð‘«ð‘¬ð‘»ð‘° ð‘¯ð‘¨ð‘°ð‘µ,\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\n {name}à¥¤ \n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\n ð‘´ð‘°ð‘ºð‘º. ð’€ð‘¶ð‘¼ ðŸ’” \n\nð‘´ð‘¨ð‘«ð‘¬ ð‘©ð’€\n\nâ—ˆâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ðŸ’šâœ¨\n\nð‘´ð’“ð‘¼ð’›ð’‚ð’Šð’“ð‘¿ð’™ð‘¿-ð‘´ð‘»ð‘¿ â—ˆ â”€â”€â”€â”€ ðŸ’šâœ¨"
];

module.exports.handleEvent = async function({ api, event, client, Users, __GLOBAL }) {
    var { threadID, messageID } = event;
    var name = await Users.getNameUser(event.senderID);

    if (event.body.toLowerCase().startsWith("Miss you") || 
        event.body.toLowerCase().startsWith("miss you") || 
        event.body.toLowerCase().startsWith("miss u")) { 

        // Select random GIF and message
        const randomGif = gifs[Math.floor(Math.random() * gifs.length)];
        const randomMessage = messages[Math.floor(Math.random() * messages.length)].replace("{name}", name);
        const downloadPath = path.join(__dirname, 'Miss-You-Sad-Gif-Images.gif');

        // Download image from Imgur
        request(randomGif).pipe(fs.createWriteStream(downloadPath)).on('close', () => {
            var msg = {
                body: randomMessage,
                attachment: fs.createReadStream(downloadPath)
            };
            api.sendMessage(msg, threadID, messageID);
            api.setMessageReaction("ðŸ’”", event.messageID, (err) => {}, true);
        });
    }
}

module.exports.run = function({ api, event, client, __GLOBAL }) {

}
